Version =20
VersionRequired =20
Begin Report
    LayoutForPrint = NotDefault
    DividingLines = NotDefault
    AllowDesignChanges = NotDefault
    DateGrouping =1
    GrpKeepTogether =1
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridY =10
    Width =5725
    DatasheetFontHeight =11
    ItemSuffix =17
    DatasheetGridlinesColor =15132391
    RecSrcDt = Begin
        0xa9beb86a93aee440
    End
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0x6801000068010000680100006801000000000000521b00004017000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    OnLoad ="[Event Procedure]"
    FilterOnLoad =0
    FitToPage =1
    DisplayOnSharePointSite =1
    DatasheetAlternateBackColor =15921906
    DatasheetGridlinesColor12 =0
    FitToScreen =1
    DatasheetBackThemeColorIndex =1
    BorderThemeColorIndex =3
    ThemeFontIndex =1
    ForeThemeColorIndex =0
    AlternateBackThemeColorIndex =1
    AlternateBackShade =95.0
    Begin
        Begin Label
            BackStyle =0
            FontSize =11
            FontName ="Calibri"
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =0
            BorderTint =50.0
            ForeThemeColorIndex =0
            ForeTint =50.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin Rectangle
            BorderLineStyle =0
            Width =850
            Height =850
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin OptionGroup
            BorderLineStyle =0
            Width =1701
            Height =1701
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            BorderLineStyle =0
            Width =1701
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            ShowDatePicker =0
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ThemeFontIndex =1
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin ListBox
            BorderLineStyle =0
            Width =1701
            Height =1417
            LabelX =-1701
            FontSize =11
            FontName ="Calibri"
            AllowValueListEdits =1
            InheritValueList =1
            ThemeFontIndex =1
            BackThemeColorIndex =1
            BorderThemeColorIndex =1
            BorderShade =65.0
            ForeThemeColorIndex =0
            ForeTint =75.0
            GridlineThemeColorIndex =1
            GridlineShade =65.0
        End
        Begin PageHeader
            Height =1134
            Name ="Paginakoptekstsectie"
            AutoHeight =1
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
        Begin Section
            KeepTogether = NotDefault
            Height =5952
            Name ="Details"
            AutoHeight =1
            AlternateBackColor =15921906
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
            Begin
                Begin TextBox
                    IMESentenceMode =3
                    Left =3174
                    Top =285
                    Height =315
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtUserAmount"
                    GridlineColor =10921638

                    LayoutCachedLeft =3174
                    LayoutCachedTop =285
                    LayoutCachedWidth =4875
                    LayoutCachedHeight =600
                    Begin
                        Begin Label
                            Left =570
                            Top =289
                            Width =1800
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Bijschrift1"
                            Caption ="Aantal Gebruikers:"
                            GridlineColor =10921638
                            LayoutCachedLeft =570
                            LayoutCachedTop =289
                            LayoutCachedWidth =2370
                            LayoutCachedHeight =604
                        End
                    End
                End
                Begin OptionGroup
                    Left =345
                    Top =1033
                    Width =4876
                    Height =1620
                    TabIndex =1
                    BorderColor =10921638
                    Name ="Kader2"
                    GridlineColor =10921638

                    LayoutCachedLeft =345
                    LayoutCachedTop =1033
                    LayoutCachedWidth =5221
                    LayoutCachedHeight =2653
                    Begin
                        Begin Label
                            BackStyle =1
                            Left =470
                            Top =915
                            Width =1815
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Bijschrift3"
                            Caption ="Verkoopgegevens."
                            GridlineColor =10921638
                            LayoutCachedLeft =470
                            LayoutCachedTop =915
                            LayoutCachedWidth =2285
                            LayoutCachedHeight =1230
                        End
                    End
                End
                Begin TextBox
                    IMESentenceMode =3
                    Left =3179
                    Top =1424
                    Height =315
                    TabIndex =2
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtSellerPercentage"
                    GridlineColor =10921638

                    LayoutCachedLeft =3179
                    LayoutCachedTop =1424
                    LayoutCachedWidth =4880
                    LayoutCachedHeight =1739
                    Begin
                        Begin Label
                            Left =575
                            Top =1425
                            Width =2160
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Bijschrift5"
                            Caption ="Percentage verkopers:"
                            GridlineColor =10921638
                            LayoutCachedLeft =575
                            LayoutCachedTop =1425
                            LayoutCachedWidth =2735
                            LayoutCachedHeight =1740
                        End
                    End
                End
                Begin TextBox
                    IMESentenceMode =3
                    Left =3174
                    Top =2097
                    Height =315
                    TabIndex =3
                    BorderColor =10921638
                    ForeColor =4210752
                    Name ="txtBidPercentage"
                    GridlineColor =10921638

                    LayoutCachedLeft =3174
                    LayoutCachedTop =2097
                    LayoutCachedWidth =4875
                    LayoutCachedHeight =2412
                    Begin
                        Begin Label
                            Left =570
                            Top =1860
                            Width =2430
                            Height =585
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Bijschrift7"
                            Caption ="Percentage biedingen:      (t.o.v.) Aantal gebruikers"
                            GridlineColor =10921638
                            LayoutCachedLeft =570
                            LayoutCachedTop =1860
                            LayoutCachedWidth =3000
                            LayoutCachedHeight =2445
                        End
                    End
                End
                Begin OptionGroup
                    Left =396
                    Top =3174
                    Width =4933
                    Height =2211
                    TabIndex =4
                    BorderColor =10921638
                    Name ="Kader10"
                    GridlineColor =10921638

                    LayoutCachedLeft =396
                    LayoutCachedTop =3174
                    LayoutCachedWidth =5329
                    LayoutCachedHeight =5385
                    Begin
                        Begin Label
                            BackStyle =1
                            Left =510
                            Top =3060
                            Width =990
                            Height =315
                            BorderColor =8355711
                            ForeColor =8355711
                            Name ="Bijschrift11"
                            Caption ="Geografie"
                            GridlineColor =10921638
                            LayoutCachedLeft =510
                            LayoutCachedTop =3060
                            LayoutCachedWidth =1500
                            LayoutCachedHeight =3375
                        End
                    End
                End
                Begin ListBox
                    IMESentenceMode =3
                    ColumnCount =2
                    Left =566
                    Top =3514
                    Width =4309
                    Height =1474
                    TabIndex =5
                    ForeColor =4210752
                    BorderColor =10921638
                    Name ="lstGeo"
                    RowSourceType ="Table/Query"
                    GridlineColor =10921638

                    LayoutCachedLeft =566
                    LayoutCachedTop =3514
                    LayoutCachedWidth =4875
                    LayoutCachedHeight =4988
                End
            End
        End
        Begin PageFooter
            Height =1134
            Name ="Paginavoettekstsectie"
            AutoHeight =1
            AlternateBackThemeColorIndex =1
            AlternateBackShade =95.0
            BackThemeColorIndex =1
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database

Private Sub Report_Load()
    Dim db As Database
    Dim rs As DAO.Recordset ''Requires reference to Microsoft DAO x.x Library
    Dim sSQL As String
    
    'Query that calculates the percentage of users
    sSQL = "SELECT COUNT(*) AS counted FROM (SELECT DISTINCT username FROM users)"

    Set db = CurrentDb
    Set rs = db.OpenRecordset(sSQL)
    
     If rs.RecordCount > 0 Then
       Me.txtUserAmount = rs!counted
    Else
       Me.txtUserAmount = "N/A"
    End If
    
    'Query that calculates the percentage of users
    sSQL = "SELECT LEFT((count(username)*100/(select count(*) from users)),2) + ' %' as percentage " & _
    "FROM sellers"

    Set rs = db.OpenRecordset(sSQL)
    
    If rs.RecordCount > 0 Then
       Me.txtSellerPercentage = rs!percentage
    Else
       Me.txtSellerPercentage = "N/A"
    End If
    
    'Query that calculates the percentage bids in relation to the total users
    sSQL = "SELECT LEFT((SELECT count(*) FROM (SELECT DISTINCT username FROM bids)) * 100 / (select count(*) from users),2) + ' %' AS percentage FROM users"

    Set rs = db.OpenRecordset(sSQL)
    
    If rs.RecordCount > 0 Then
       Me.txtBidPercentage = rs!percentage
    Else
       Me.txtBidPercentage = "N/A"
    End If
    
    'Query that calculates the percentage bids in relation to the total users
    query = "SELECT city, count(*) FROM Users GROUP BY city ORDER BY count(*) DESC"
    ' Can't get top 3 !!!!
    
    MsgBox query

    Me.lstGeo.RowSource = query
    
    
End Sub
